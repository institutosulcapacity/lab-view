<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Laboratório Virtual – Comandos Elétricos</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#1c1c1c;
  color:#fff;
  font-family:Arial, sans-serif;
  text-align:center;
}

h1{ margin:20px 0; }

svg{
  background:#2b2b2b;
  border-radius:16px;
}

.comp{
  fill:#e6e6e6;
  stroke:#555;
  stroke-width:2;
}

.label{
  font-size:12px;
  fill:#000;
  pointer-events:none;
}

.borne{
  fill:#111;
  stroke:#fff;
  stroke-width:2;
  cursor:pointer;
}

.borne:hover{
  fill:#00aaff;
}

.fio{
  stroke:#f1c40f;
  stroke-width:5;
}
</style>
</head>

<body>

<h1>Laboratório Virtual – Montagem de Comandos Elétricos</h1>

<svg id="painel" width="420" height="560">

  <!-- DISJUNTOR DIN -->
  <g>
    <rect x="130" y="20" width="160" height="70" rx="6" class="comp"/>
    <rect x="200" y="35" width="20" height="30" rx="3" fill="#333"/>
    <text x="210" y="100" text-anchor="middle" class="label">DISJUNTOR</text>
    <text x="150" y="60" font-size="10">L</text>
    <circle cx="210" cy="110" r="6" class="borne" data-id="disj_out"/>
  </g>

  <!-- CONTATOR -->
  <g>
    <rect x="110" y="140" width="200" height="90" rx="6" class="comp"/>
    <rect x="150" y="165" width="40" height="20" fill="#ccc"/>
    <rect x="230" y="165" width="40" height="20" fill="#ccc"/>
    <text x="210" y="160" text-anchor="middle" class="label">CONTATOR</text>
    <text x="150" y="205" font-size="10">A1</text>
    <text x="250" y="205" font-size="10">A2</text>
    <circle cx="210" cy="135" r="6" class="borne" data-id="cont_in"/>
    <circle cx="210" cy="235" r="6" class="borne" data-id="cont_out"/>
  </g>

  <!-- TEMPORIZADOR TON -->
  <g>
    <rect x="110" y="270" width="200" height="90" rx="6" class="comp"/>
    <circle cx="210" cy="315" r="18" fill="#fff" stroke="#333" stroke-width="2"/>
    <line x1="210" y1="315" x2="225" y2="305" stroke="#000" stroke-width="2"/>
    <text x="210" y="365" text-anchor="middle" class="label">TEMPORIZADOR TON</text>
    <circle cx="210" cy="265" r="6" class="borne" data-id="temp_in"/>
    <circle cx="210" cy="365" r="6" class="borne" data-id="temp_out"/>
  </g>

  <!-- MOTOR IEC -->
  <g>
    <ellipse cx="210" cy="455" rx="90" ry="35" fill="#bfbfbf" stroke="#555" stroke-width="2"/>
    <circle cx="290" cy="455" r="6" fill="#444"/>
    <text x="210" y="460" text-anchor="middle" class="label">MOTOR</text>
    <circle cx="210" cy="410" r="6" class="borne" data-id="motor_in"/>
  </g>

</svg>

<script>
document.addEventListener("DOMContentLoaded",()=>{

const svg = document.getElementById("painel");
let fio=null, origem=null;
const ocupados={};

const validas={
  disj_out:"cont_in",
  cont_out:"temp_in",
  temp_out:"motor_in"
};

svg.addEventListener("mousedown",e=>{
  if(e.target.classList.contains("borne")){
    const id=e.target.dataset.id;
    if(ocupados[id]){ alert("Borne ocupado"); return;}
    origem=e.target;
    fio=document.createElementNS("http://www.w3.org/2000/svg","line");
    fio.setAttribute("x1",origem.cx.baseVal.value);
    fio.setAttribute("y1",origem.cy.baseVal.value);
    fio.setAttribute("x2",origem.cx.baseVal.value);
    fio.setAttribute("y2",origem.cy.baseVal.value);
    fio.setAttribute("class","fio");
    svg.appendChild(fio);
  }
});

svg.addEventListener("mousemove",e=>{
  if(!fio) return;
  const pt=svg.createSVGPoint();
  pt.x=e.clientX; pt.y=e.clientY;
  const p=pt.matrixTransform(svg.getScreenCTM().inverse());
  fio.setAttribute("x2",p.x);
  fio.setAttribute("y2",p.y);
});

svg.addEventListener("mouseup",e=>{
  if(!fio) return;
  if(e.target.classList.contains("borne") && e.target!==origem){
    const o=origem.dataset.id;
    const d=e.target.dataset.id;
    if(validas[o]===d && !ocupados[d]){
      fio.setAttribute("x2",e.target.cx.baseVal.value);
      fio.setAttribute("y2",e.target.cy.baseVal.value);
      ocupados[o]=ocupados[d]=true;
    }else{
      alert("Ligação elétrica incorreta");
      fio.remove();
    }
  }else fio.remove();
  fio=null; origem=null;
});

});
</script>

</body>
</html>
