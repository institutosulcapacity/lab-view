<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Laboratório Virtual – Conexões Elétricas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  background:#1e1e1e;
  color:#fff;
  font-family:Arial, sans-serif;
  text-align:center;
}

h1{margin:20px}

svg{
  background:#2b2b2b;
  border-radius:12px;
}

.componente{
  fill:#555;
  stroke:#aaa;
  stroke-width:2;
}

.borne{
  fill:#111;
  stroke:#fff;
  stroke-width:2;
  cursor:pointer;
}

.borne:hover{
  fill:#3498db;
}

.fio{
  stroke:#f1c40f;
  stroke-width:5;
}
</style>
</head>

<body>

<h1>Laboratório Virtual – Conexões</h1>

<svg id="painel" width="400" height="300">

  <!-- COMPONENTE A -->
  <rect x="40" y="80" width="120" height="60" rx="10" class="componente"/>
  <text x="100" y="115" text-anchor="middle">FONTE</text>
  <circle cx="160" cy="110" r="6" class="borne" data-id="A"/>

  <!-- COMPONENTE B -->
  <rect x="240" y="80" width="120" height="60" rx="10" class="componente"/>
  <text x="300" y="115" text-anchor="middle">CARGA</text>
  <circle cx="240" cy="110" r="6" class="borne" data-id="B"/>

</svg>

<script>
const svg = document.getElementById("painel");
let fioAtual = null;
let origem = null;

svg.addEventListener("mousedown", e => {
  if(e.target.classList.contains("borne")){
    origem = e.target;
    fioAtual = document.createElementNS("http://www.w3.org/2000/svg","line");
    fioAtual.setAttribute("x1", origem.cx.baseVal.value);
    fioAtual.setAttribute("y1", origem.cy.baseVal.value);
    fioAtual.setAttribute("x2", origem.cx.baseVal.value);
    fioAtual.setAttribute("y2", origem.cy.baseVal.value);
    fioAtual.setAttribute("class","fio");
    svg.appendChild(fioAtual);
  }
});

svg.addEventListener("mousemove", e => {
  if(fioAtual){
    const pt = svg.createSVGPoint();
    pt.x = e.clientX;
    pt.y = e.clientY;
    const cursor = pt.matrixTransform(svg.getScreenCTM().inverse());
    fioAtual.setAttribute("x2", cursor.x);
    fioAtual.setAttribute("y2", cursor.y);
  }
});

svg.addEventListener("mouseup", e => {
  if(fioAtual){
    if(e.target.classList.contains("borne") && e.target !== origem){
      fioAtual.setAttribute("x2", e.target.cx.baseVal.value);
      fioAtual.setAttribute("y2", e.target.cy.baseVal.value);
    } else {
      fioAtual.remove();
    }
    fioAtual = null;
    origem = null;
  }
});
</script>

</body>
</html>
